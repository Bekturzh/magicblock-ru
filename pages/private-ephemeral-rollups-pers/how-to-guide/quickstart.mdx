---
title: "Управление доступом"
description: "Обеспечьте конфиденциальность любого аккаунта состояния программы на Solana с помощью ЭР от MagicBlock и среды доверенного исполнения (TEE) на Intel TDX."
---

import Endpoints from "/snippets/endpoints.mdx";
import Validators from "/snippets/validators.mdx";
import Construction from "/snippets/construction.mdx";
import Software from "/snippets/software.mdx";
import SolanaResources from "/snippets/solana-resources.mdx";

import WriteProgramCode from "/snippets/per-rps-code/write-program.mdx";
import DelegateCode from "/snippets/per-rps-code/delegate.mdx";
import RestrictCode from "/snippets/per-rps-code/restrict.mdx";
import AuthorizeCode from "/snippets/per-rps-code/authorize.mdx";
import DelegationInfo from "/snippets/delegation-info.mdx";

import QuickAccessPER from "/snippets/quick-access-per.mdx";
import PerCards from "/snippets/per-cards.mdx";

---

<QuickAccessPER />

---

## Пошаговое руководство

Создайте вашу программу и обновите её с хуками разрешений и делегирования, используя Permission Program MagicBlock `ACLseoPoyC3cBqoUtkbjZ4aDrkurZW86v19pXz2XQnp1` и Delegation Program `DELeGGvXpWV2fqJUhqcF5ZSYMS4JTLjteaAMARRSaeSh`:

<Steps>
  <Step title={<a href="#1-write-program">Write your program</a>}>
    **Пишите вашу программу на Solana как обычно.**
  </Step>
  <Step title='
    <a href="#2-restrict">
      Add restrictions through permission hooks in your program.
    </a>
  '>
    Добавьте хуки разрешений для создания и управления контролем доступа, [посмотреть детали](/pages/private-ephemeral-rollups-pers/how-to-guide/access-control)
  </Step>
  <Step title={<a href="#3-delegate">Add delegation hooks in your program</a>}>
    **Добавьте хуки делегирования для разрешений и аккаунтов с ограниченным доступом, чтобы применять ограничения.**

    <Validators />
  </Step>
  <Step title={<a href="#4-deploy">Deploy your program on Solana</a>}>
    Разверните вашу программу на Solana с помощью Anchor CLI.
  </Step>
  <Step title={<a href="#5-authorize">Implement authorization in your client</a>}>
    Подпишите сообщение пользователя, чтобы получить токен авторизации с TEE-эндпоинта.
  </Step>
  <Step title={<a href="#6-test">Execute transactions and test privacy</a>}>
    Запросите токен авторизации и отправляйте конфиденциальные транзакции.
  </Step>
</Steps>

---

## Пример «Камень-Ножницы-Бумага»

<Software />

<Note>
  The latest Permission Program requires SDK version [\>=0.8.0](https://github.com/magicblock-labs/ephemeral-rollups-sdk). See [migration
  guide](https://github.com/magicblock-labs/ephemeral-rollups-sdk/pull/103) for details.
</Note>

### Фрагменты Кода

<Tabs>
  <Tab title="1. Напиши программу">
    **Простая программа «Камень-Ножницы-Бумага», где игрок может делать выбор и видеть результат:**

    <WriteProgramCode />

    [⬆️ Вернуться к началу](#code-snippets)
  </Tab>
  <Tab title="2. Restrict">
    Создавайте и обновляйте разрешения на уровне аккаунта для участников через Permission Program от MagicBlock`ACLseoPoyC3cBqoUtkbjZ4aDrkurZW86v19pXz2XQnp1`, [посмотреть детали](/pages/private-ephemeral-rollups-pers/how-to-guide/access-control)

    <RestrictCode />

    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="3. Делегировать">
    Обеспечьте конфиденциальность аккаунтов через делегирование валидатору TEE с помощью Delegation Program от MagicBlock `DELeGGvXpWV2fqJUhqcF5ZSYMS4JTLjteaAMARRSaeSh`; как аккаунт с разрешением, так и аккаунт с ограниченным доступом должны быть делегированы.

    <Validators />

    <DelegateCode />

    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="4. Развернуть">
    Теперь ваша программа обновлена и готова! Создавайте и разворачивайте её в нужном кластере:

    ```bash
      anchor build && anchor deploy
    ```

    [⬆️ Вернуться к началу ](#code-snippets)
  </Tab>
  <Tab title="5. Авторизовать">
    **Настройте взаимодействие с ER RPC в TEE:**

    - Проверьте целостность TEE RPC через https://pccs.phala.network/tdx/certification/v4
    - Запросите токен авторизации для пользователя для взаимодействия с TEE-эндпоинтом

    <AuthorizeCode />

    [⬆️ Back to Top](#code-snippets)
  </Tab>
  <Tab title="6. Тест">
    Протестируйте вашу программу с подключением к Приватному Эфемер Роллап:

    `https://tee.magicblock.app?token=${token}`

    <Validators />

    <QuickAccessPER />

    [⬆️ Вернуться к началу](#code-snippets)
  </Tab>
</Tabs>

---

<PerCards />

---

<SolanaResources />

---

## MagicBlock Products

import ProductCards from "/snippets/product-cards.mdx";

<ProductCards />

---